# Application Configuration
spring.application.name=aml-fraud-detector
server.port=${SERVER_PORT:2637}
server.servlet.context-path=${CONTEXT_PATH:/api/v1}

# Internationalization (i18n) Configuration
spring.messages.basename=messages/messages
spring.messages.encoding=UTF-8
spring.messages.fallback-to-system-locale=true
spring.messages.cache-duration=3600

# Default Locale
spring.web.locale=en
spring.web.locale-resolver=fixed

# Tomcat Thread Pool Configuration (Ultra High Throughput - 30K+ requests)
server.tomcat.threads.min-spare=${TOMCAT_MIN_SPARE:200}
server.tomcat.threads.max=${TOMCAT_MAX_THREADS:1000}
server.tomcat.max-connections=${TOMCAT_MAX_CONNECTIONS:10000}
server.tomcat.accept-count=${TOMCAT_ACCEPT_COUNT:5000}
server.tomcat.connection-timeout=${TOMCAT_CONNECTION_TIMEOUT:20000}
server.tomcat.keep-alive-timeout=${TOMCAT_KEEPALIVE_TIMEOUT:60000}
server.tomcat.max-keep-alive-requests=${TOMCAT_MAX_KEEPALIVE:1000}

# HTTP/2 Support - Dynamic Auto-Detection and Failover
server.http2.enabled=${HTTP2_ENABLED:false}

# HTTP/2 Auto-Detection Configuration
http2.auto.detect.enabled=${HTTP2_AUTO_DETECT_ENABLED:true}
http2.detection.test.url=${HTTP2_DETECTION_TEST_URL:http://localhost:8080/actuator/health}
http2.detection.timeout.ms=${HTTP2_DETECTION_TIMEOUT:5000}
http2.detection.refresh.interval.seconds=${HTTP2_DETECTION_REFRESH_INTERVAL:300}

# HTTP/2 Health Monitoring Configuration
http2.health.monitoring.enabled=${HTTP2_HEALTH_MONITORING_ENABLED:true}
http2.health.check.interval.seconds=${HTTP2_HEALTH_CHECK_INTERVAL:30}
http2.failover.drop.threshold=${HTTP2_FAILOVER_DROP_THRESHOLD:10}
http2.failover.error.rate.threshold=${HTTP2_FAILOVER_ERROR_RATE_THRESHOLD:0.05}
http2.failover.latency.threshold.ms=${HTTP2_FAILOVER_LATENCY_THRESHOLD:1000}

# HTTP/2 Failover Configuration
http2.failover.enabled=${HTTP2_FAILOVER_ENABLED:true}
http2.failover.retry.interval.seconds=${HTTP2_FAILOVER_RETRY_INTERVAL:300}
http2.failover.min.retry.interval.seconds=${HTTP2_FAILOVER_MIN_RETRY_INTERVAL:60}
http2.failover.auto.retry.enabled=${HTTP2_FAILOVER_AUTO_RETRY_ENABLED:true}

# HTTP/2 Network Stability Configuration (Background Process)
http2.network.stability.enabled=${HTTP2_NETWORK_STABILITY_ENABLED:true}
http2.network.stability.check.interval.seconds=${HTTP2_NETWORK_STABILITY_CHECK_INTERVAL:30}
http2.network.stability.test.url=${HTTP2_NETWORK_STABILITY_TEST_URL:http://localhost:8080/actuator/health}
http2.network.stability.timeout.ms=${HTTP2_NETWORK_STABILITY_TIMEOUT:5000}
http2.network.stability.success.threshold=${HTTP2_NETWORK_STABILITY_SUCCESS_THRESHOLD:5}
http2.network.stability.failure.threshold=${HTTP2_NETWORK_STABILITY_FAILURE_THRESHOLD:3}

# Compression
server.compression.enabled=${COMPRESSION_ENABLED:true}
server.compression.mime-types=application/json,application/xml,text/html,text/xml,text/plain
server.compression.min-response-size=1024

# SpringDoc OpenAPI (Swagger) Configuration
springdoc.api-docs.path=/api-docs
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.swagger-ui.enabled=${SWAGGER_UI_ENABLED:true}
springdoc.swagger-ui.operationsSorter=method
springdoc.swagger-ui.tagsSorter=alpha
springdoc.swagger-ui.tryItOutEnabled=true
springdoc.swagger-ui.filter=true
springdoc.swagger-ui.displayRequestDuration=true
springdoc.swagger-ui.showExtensions=true
springdoc.swagger-ui.showCommonExtensions=true
springdoc.swagger-ui.disable-swagger-default-url=true
springdoc.swagger-ui.config-url=/api-docs/swagger-config
springdoc.swagger-ui.validator-url=
springdoc.default-consumes-media-type=application/json
springdoc.default-produces-media-type=application/json
springdoc.paths-to-match=/api/v1/**
springdoc.packages-to-scan=com.posgateway.aml.controller
springdoc.show-actuator=false

# Database Configuration
spring.datasource.url=${DATABASE_URL:jdbc:postgresql://localhost:5432/aml_fraud_db}
spring.datasource.username=${DATABASE_USERNAME:postgres}
spring.datasource.password=${DATABASE_PASSWORD:Tr13com012009!}
spring.datasource.driver-class-name=org.postgresql.Driver

# JPA/Hibernate Configuration
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.show-sql=${HIBERNATE_SHOW_SQL:false}
spring.jpa.properties.hibernate.format_sql=${HIBERNATE_FORMAT_SQL:true}

# Flyway Configuration
spring.flyway.enabled=true
spring.flyway.baseline-on-migrate=true
spring.flyway.validate-on-migrate=false
spring.flyway.locations=classpath:db/migration

# Sumsub Configuration (with defaults)
sumsub.enabled=${SUMSUB_ENABLED:false}
sumsub.api.url=${SUMSUB_API_URL:https://api.sumsub.com/resources}
sumsub.api.key=${SUMSUB_API_KEY:dev-placeholder-key}
sumsub.api.secret=${SUMSUB_API_SECRET:dev-placeholder-secret}
sumsub.cost.per.check=${SUMSUB_COST_PER_CHECK:1.85}

# Sanctions Configuration (with defaults)
sanctions.download.enabled=${SANCTIONS_DOWNLOAD_ENABLED:false}
sanctions.opensanctions.url=${SANCTIONS_OPENSANCTIONS_URL:https://api.opensanctions.org/datasets/latest/default/entities.json}
sanctions.opensanctions.metadata.url=${SANCTIONS_OPENSANCTIONS_METADATA_URL:https://api.opensanctions.org/datasets/latest/default/index.json}

# Database Query Logging (for performance optimization)
# Enable to log slow queries (> 1 second)
spring.jpa.properties.hibernate.show_sql=${HIBERNATE_SHOW_SQL:false}
spring.jpa.properties.hibernate.format_sql=${HIBERNATE_FORMAT_SQL:true}
spring.jpa.properties.hibernate.use_sql_comments=${HIBERNATE_USE_SQL_COMMENTS:true}
# Log slow queries (requires pg_stat_statements extension)
logging.level.org.hibernate.SQL=${HIBERNATE_SQL_LOG_LEVEL:WARN}
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=${HIBERNATE_BINDER_LOG_LEVEL:WARN}
# Enable query statistics (for performance analysis)
spring.jpa.properties.hibernate.generate_statistics=${HIBERNATE_STATISTICS:false}
# Slow query threshold (milliseconds)
spring.jpa.properties.hibernate.session.events.log.LOG_QUERIES_SLOWER_THAN_MS=${SLOW_QUERY_THRESHOLD:1000}